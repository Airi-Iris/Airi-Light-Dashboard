import{d as D,W as R,D as N,u as I,Y as P,b as x,ax as T,ay as z,az as i,av as A,r as q,a2 as H,o as M,R as r,e,O as L,F as l,ak as d,m,n as O,a7 as p,g as v,p as V,T as f,s as g,aj as W,al as b,aA as $,an as j}from"./index-DYGX83NG.js";const Y=D({setup(){const w=R(),h=N(),B=I(P),E=x(B.viewport.value.mobile),k=()=>({text:"",author:"",source:""}),o=x({});T(()=>{z([i.原创,i.哲学,i.文学,i.诗词]).then(a=>{o.value={source:a.from,text:a.hitokoto,author:a.from_who||a.creator}})});const F=A(),y=async()=>{const a=async()=>{await r.api.says.post({data:o.value}),message.success("发布成功"),h.push({name:b.ListSay})};t.text||t.author||t.source?F.create({title:"警告",content:"发布一言会覆盖现有的内容，要继续吗",type:"warning",negativeText:"取消",positiveText:"确定",onPositiveClick(){a()}}):a()},S=a=>W(t)(a),t=q(k()),n=H(()=>w.query.id);M(async()=>{const a=n.value;if(a&&typeof a=="string"){const u=(await r.api.says(a).get({})).data;S(u)}});const c=async()=>{const a=()=>{try{if(!t.text||t.text.trim().length==0)throw"内容为空";return{...$(j(t),(s,u,C)=>(s[C]=typeof u>"u"?null:typeof u=="string"&&u.length==0?"":u,s)),text:t.text.trim()}}catch(s){throw message.error(s),s}};if(n.value){if(!d(n.value))return;const s=n.value;await r.api.says(s).put({data:a()}),message.success("修改成功")}else await r.api.says.post({data:a()}),message.success("发布成功");h.push({name:b.ListSay})};return()=>e(l,null,[e(L,{className:"space-x-2"},{default:()=>[e(l,null,[d(n)?e(m,{name:"更新",className:"bg-[#2080f0] dark:bg-[#1668dc]",onClick:c,icon:e("i",{class:"icon-[mingcute--send-plane-line]"},null)},null):e(l,null,[e(m,{name:"发布一言",onClick:y,className:"bg-[#2080f0] dark:bg-[#1668dc]",icon:e("i",{class:"icon-[mingcute--chat-2-line]"},null)},null),e(m,{name:"发布自己说的",onClick:c,className:"bg-accent size-[30px]",icon:e("i",{class:"icon-[mingcute--send-plane-line]"},null)},null)])])]}),e(O,{class:"mt-16 rounded-md",headerExtra:()=>E.value?null:e(l,null,[e("div",{class:"shrink grow"},null),e("div",{class:"flex grow-0 items-center gap-4"},[e("div",{class:"flex gap-2"},[d(n)?e(p,{icon:e("i",{class:"icon-[mingcute--send-plane-line] size-[16px]"},null),variant:"primary",class:"bg-[#2080f0] dark:bg-[#1668dc]",description:"更新",onClick:c},null):e(l,null,[e(p,{icon:e("i",{class:"icon-[mingcute--chat-2-line] size-[16px]"},null),variant:"secondary",class:"rounded-lg",description:"发布一言",onClick:y},null),e(p,{icon:e("i",{class:"icon-[mingcute--send-plane-line] size-[16px]"},null),variant:"primary",description:"发布自己说的",onClick:c},null)])])])])},{header(){return e(l,null,[e("div",{class:"flex flex-col mb-4 select-none"},[e("h1",{class:"flex items-center text-[1.73rem]"},[v("说点什么呢")]),e("h2",{class:"opacity-80 text-sm"},[v("说说 · 说点什么呢")])])])},default(){return e(l,null,[e(V,null,{default:()=>[e(f,{label:"内容",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},{default:()=>[e(g,{type:"textarea",autofocus:!0,autosize:{minRows:6,maxRows:8},placeholder:o.value.text,value:t.text,onInput:a=>void(t.text=a),class:"rounded-lg"},null)]}),e(f,{label:"作者",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},{default:()=>[e(g,{placeholder:o.value.author,value:t.author,onInput:a=>void(t.author=a),class:"rounded-lg"},null)]}),e(f,{label:"来源",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},{default:()=>[e(g,{placeholder:o.value.source,value:t.source,onInput:a=>void(t.source=a),class:"rounded-lg"},null)]})]})])}})])}});export{Y as default};
