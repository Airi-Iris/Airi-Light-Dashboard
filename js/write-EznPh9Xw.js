import{d as E,u as S,Y as I,W as C,r as P,a2 as R,o as F,R as r,b as D,c as N,D as k,w as A,a3 as U,e as a,a4 as B,F as n,a5 as M,a6 as T,a7 as V,a8 as W,g as p,a9 as m,aa as H,ab as $,ac as L,ad as q,ae as Y,af as g,ag as j,I as z,ah as K,ai as O,T as _,aj as G,ak as J,al as Q,am as X,an as Z}from"./index-DYGX83NG.js";const te=E(()=>{const d=S(I).viewport.value.mobile,v=C(),f=()=>({text:"",title:"",order:0,slug:"",subtitle:"",allowComment:!0,id:void 0,images:[],meta:void 0}),b=t=>G(e)(t),e=P(f()),s=R(()=>v.query.id);F(async()=>{const t=s.value;if(t&&typeof t=="string"){const o=(await r.api.pages(t).get({})).data;b(o)}});const u=D(!1),i=N(),h=k(),w=async()=>{const t=()=>{try{if(!e.title||e.title.trim().length==0)throw"标题为空";if(!e.slug)throw"路径为空";return{...Z(e),title:e.title.trim(),slug:e.slug.trim()}}catch(l){throw i.error(l),l}};if(s.value){if(!J(s.value))return;const l=s.value;await r.api.pages(l).put({data:t()}),i.success("修改成功")}else await r.api.pages.post({data:t()}),i.success("发布成功");h.push({name:Q.ListPage,hash:"|publish"})};A(()=>e,()=>{window.dispatchEvent(new CustomEvent(X.EditDataUpdate))},{deep:!0});const c=U(":l").concat(":");return()=>a(n,null,[a(B,{title:s.value?`编辑「${e.title}」`:"添加页面",headerClass:"pt-4",actionsElement:a(n,null,[a("div",{class:"shrink grow"},null),a("div",{class:"flex grow-0 items-center gap-4"},[a("div",{class:"flex gap-2"},[a(M,{data:e,onHandleYamlParsedMeta:t=>{const{title:l,slug:o,subtitle:x,...y}=t;e.title=l??e.title,e.slug=o??e.slug,e.subtitle=x??e.subtitle,e.meta={...y}}},null),a(T,{getData:()=>({...e}),iframe:!0},null)]),a(V,{icon:a("i",{class:"icon-[mingcute--send-plane-line] size-[16px]"},null),variant:"primary",description:"发布",onClick:w},null)])]),contentElement:a(n,null,[a(W,{label:"希望你有个好心情~",labelPlacement:"inside",labelClassNames:"text-xs",inputClassNames:"text-base font-medium",value:e.title,onChange:t=>{e.title=t}},null),a("div",{class:"pt-2 text-gray-700 dark:text-gray-300"},[a("span",{class:"text-[14px]"},[p("副标题：")]),a(m,{value:e.subtitle,onChange:t=>void(e.subtitle=t)},null)]),a("div",{class:"my-3 flex items-center text-sm text-gray-500"},[a("label",{class:"prefix text-base-content",id:c},[p("地址："),`${H}/`]),a(m,{id:c,value:e.slug,onChange:t=>{e.slug=t}},null)]),a($,null,{default:()=>[a(L,{key:e.id,loading:!!(s.value&&typeof e.id>"u"),onChange:t=>{e.text=t},text:e.text},null)]})]),sidebarElement:a(n,null,[a("div",{class:"hidden flex-col lg:flex"},[a(q,null,{default:()=>[a(Y,{label:"页面顺序"},{default:()=>[a(g,{placeholder:"",value:e.order,onUpdateValue:t=>void(e.order=t??0),themeOverrides:{peers:{Input:{borderRadius:"0.5rem"}}}},null)]}),a(j,{data:e},null)]})])]),footerButtonElement:a(n,null,[a("button",{onClick:()=>{u.value=!0},class:d?"":"!hidden"},[a(z,null,{default:()=>[a(K,null,null)]})])])},{default:()=>[d&&a(O,{disabledItem:["date-picker"],onUpdateShow:t=>{u.value=t},data:e,show:u.value},{default:()=>[a(_,{label:"页面顺序"},{default:()=>[a(g,{placeholder:"",value:e.order,onUpdateValue:t=>void(e.order=t??0)},null)]})]})]})])});export{te as default};
