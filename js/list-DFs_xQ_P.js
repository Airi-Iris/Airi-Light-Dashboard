import{d as y,X as F,c as k,av as R,W as b,w as D,o as S,u as T,Y as N,e,F as i,f as C,g as l,O as q,aw as E,R as o,m as M,r as j,a0 as L,l as m,B as f,j as K,i as P,aq as V}from"./index-DrqTzKeg.js";const O=y({name:"SayList",setup($,z){const{checkedRowKeys:n,data:g,pager:c,loading:v,fetchDataFn:w}=F((t,a)=>async(s=d.query.page||1,B=30)=>{const p=await o.api.says.get({params:{page:s,size:B,select:"title text _id id created modified author source"}});t.value=p.data,a.value=p.pagination}),r=k();R();const d=b(),u=w;D(()=>d.query.page,async t=>{await u(t)}),S(async()=>{await u()});const x=y({setup(){const t=j([{type:"selection",options:["none","all"]},{title:"创建于",key:"created",width:100,render(a){return e(m,{to:`/says/edit?id=${a.id}`},{default:()=>[e(L,{time:a.created},null)]})}},{title:"内容",key:"text"},{title:"作者",key:"author"},{title:"来源",key:"source"},{title:"操作",fixed:"right",key:"id",width:130,render(a){return e(P,{wrap:!1},{default:()=>[e(m,{to:`/says/edit?id=${a.id}`},{default:()=>[e(f,{quaternary:!0,type:"primary",size:"tiny"},{default:()=>[l("编辑")]})]}),e(K,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await o.api.says(a.id).delete(),r.success("删除成功"),await u(c.value.currentPage)}},{trigger:()=>e(f,{quaternary:!0,type:"error",size:"tiny"},{default:()=>[l("移除")]}),default:()=>e("span",{class:"max-w-48"},[l("确定要删除“"),a.text,l("” ?")])})]})}}]);return()=>e(V,{loading:v.value,columns:t,data:g,onFetchData:u,pager:c,onUpdateCheckedRowKeys:a=>{n.value=a}},null)}}),h=T(N);return()=>{const t=h.viewport.value.mobile;return e(i,null,[e("div",{class:"relative"},[e(i,null,[e("div",{class:C("flex flex-wrap items-center justify-between pt-4 lg:mb-5")},[e("div",{class:"flex items-center justify-between"},[e("p",{class:"flex items-center text-lg font-medium"},[t?e("div",null,null):e("span",null,[l("说说 · 说什么了呢")])])])]),e(x,null,null)])]),e(q,{className:"space-x-2"},{default:()=>[e(i,null,[e(E,{checkedRowKeys:n.value,onDelete:async()=>{const a=await Promise.allSettled(n.value.map(s=>o.api.says(s).delete()));for(const s of a)s.status==="rejected"&&r.success(`删除失败，${s.reason.message}`);n.value.length=0,u()}},null),e(M,{className:"bg-accent",name:"撰写",to:"/says/edit",icon:e("i",{class:"icon-[mingcute--add-line] text-white"},null)},null)])]})])}}});export{O as default};
